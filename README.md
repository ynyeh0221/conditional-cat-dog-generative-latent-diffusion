# LatentDiffuPet: VAE-Enhanced Animal Generation

LatentDiffuPet: VAE-Enhanced Animal Generation is a deep learning project that combines Variational Autoencoders (VAE) with diffusion models to generate realistic cat and dog images from the CIFAR-10 and STL-10 dataset. This implementation features a novel two-stage approach where images are first compressed into a structured latent space using an attention-enhanced VAE, followed by a class-conditional diffusion process that enables controlled generation of specific animal classes.

The project showcases advanced deep learning techniques including channel attention mechanisms, center loss for improved class separation, and optimized training with separate pathways for reconstruction and classification. The codebase includes comprehensive visualization tools that provide fascinating insights into the latent space structure and the step-by-step denoising process, demonstrating how diffusion models can operate efficiently in compressed latent spaces rather than directly in pixel space.

[DEEPWIKI](https://deepwiki.com/ynyeh0221/conditional-cat-dog-generative-latent-diffusion)[![Ask DeepWiki](https://deepwiki.com/badge.svg)](https://deepwiki.com/ynyeh0221/conditional-cat-dog-generative-latent-diffusion)

## STL-10

Below examples are generated by [Latent diffusion model v12](https://github.com/ynyeh0221/conditional-cat-dog-generative-latent-diffusion/tree/main/v12) of this repo:

Model Component | Visualization | Description |
|-----------------|---------------|-------------|
| GAN-VAE | ![Reconstructions](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v12/output/reconstruction/vae_reconstruction_epoch_10000.png) | Original images (top) and their reconstructions (bottom) |
| Latent Space | ![Latent Space](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v12/output/latent_space/vae_latent_space_epoch_10000.png) | t-SNE visualization of cat and dog latent representations |
| Original image v.s. Reconstruction v.s. Reconstruction from noised/denoised latent space | ![](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v12/output/diffusion_latent_space_comparison/latent_comparison_epoch_6700.png) | First row is the reconstructed image from original image's latent space. Second row is the reconstructed image from original image's latent space with noising/denoising. Third row is the original image |
| Class Samples | ![Class Samples](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v12/output/diffusion_sample_result/sample_class_cat_epoch_6700.png)![Class Samples](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v12/output/diffusion_sample_result/sample_class_dog_epoch_6700.png) | Generated samples for cat and dog classes |
| Denoising Process | ![Denoising Cat](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v12/output/diffusion_path/denoising_path_cat_epoch_6700.png)![Denoising Dog](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v12/output/diffusion_path/denoising_path_dog_epoch_6700.png) | Visualization of cat generation process and latent path |
| Animation | ![Cat Animation](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v12/animination/diffusion_animation_cat_epoch_6700.gif)![Dog Animation](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v12/animination/diffusion_animation_dog_epoch_6700.gif) | Animation of the denoising process for cat generation |

## CIFAR-10

Below examples are generated by [Latent diffusion model v10](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/tree/main/v10) of this repo:

 Model Component | Visualization | Description |
|-----------------|---------------|-------------|
| GAN-VAE | ![Reconstructions](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v10/output/reconstruction/vae_reconstruction_epoch_800.png) | Original images (top) and their reconstructions (bottom) |
| Latent Space | ![Latent Space](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v10/output/latent_space/vae_latent_space_epoch_800.png) | t-SNE visualization of cat and dog latent representations |
| Original image v.s. Reconstruction v.s. Reconstruction from noised/denoised latent space | ![](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v10/output/diffusion_latent_space_comparison/latent_comparison_epoch_800.png) | First row is the reconstructed image from original image's latent space. Second row is the reconstructed image from original image's latent space with noising/denoising. Third row is the original image |
| Class Samples | ![Class Samples](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v10/output/diffusion_sample_result/sample_class_cat_epoch_800.png)![Class Samples](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v10/output/diffusion_sample_result/sample_class_dog_epoch_800.png) | Generated samples for cat and dog classes |
| Denoising Process | ![Denoising Cat](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v10/output/diffusion_path/denoising_path_cat_epoch_800.png)![Denoising Dog](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v10/output/diffusion_path/denoising_path_dog_epoch_800.png) | Visualization of cat generation process and latent path |
| Animation | ![Cat Animation](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v10/output/diffusion_animination/diffusion_animation_cat_epoch_800.gif)![Dog Animation](https://github.com/ynyeh0221/CIFAR10-cat-dog-generative-latent-diffusion/blob/main/v10/output/diffusion_animination/diffusion_animation_dog_epoch_800.gif) | Animation of the denoising process for cat generation |

